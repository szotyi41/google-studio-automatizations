<!DOCTYPE html>
<html>
<head>
	<title>Banners</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="advert_name" content="Message 8_Smart Fit">
	
	<link rel="stylesheet" href="640x360.css">
<style>@font-face {
  font-family: "BrownPro-Light";
  src: url("BrownPro-Light.woff") format("woff");
}

@font-face {
  font-family: "BrownPro-Regular";
  src: url("BrownPro-Regular.woff2") format("woff2");
}

html {
	--color-main: #990622;
	
	/* Testing */
  /*border: 1px solid #ddd;*/
  box-sizing: border-box;
  background-color: #fff;
}

body {
  position: absolute;
  left: 0;
  top: 0;
  margin: 0;
  padding: 8px;
  font-family: "BrownPro-Regular";
  font-weight: 600;
}

a {
  text-decoration: none;
}

button {
  font-family: "BrownPro-Regular";
}

/* Image block */
.image-block {
  overflow: hidden;
  transition: all 0.3s;
 	background-position: center;
	background-size: cover;
	background-repeat: no-repeat;
}

/* Copy block */
.copy-1, .copy-2 {
  color: var(--color-main);
  text-transform: uppercase;
  border: none;
  text-decoration: none;
  white-space: pre-line;
  text-align: center;
  font-weight: 300;
  letter-spacing: 1px;
}

.copy-1 > b, .copy-2 > b {
  display: block;
  padding: 4px 0;
}

.copy-2 {
    display: none;
}


/* Brand block */
.brand-block {
  display: flex;
  flex-direction: column;
  align-items: center;
  align-content: center;
  justify-content: space-between;
  flex: 1;
}

/* CTA block */
.cta-block {
    text-align: center;
}</style>
            <script src="https://s0.2mdn.net/ads/studio/Enabler.js"></script>

            <script>
                // First of all import Enabler.js
                if (!Enabler.isInitialized()) {
                    Enabler.addEventListener(studio.events.StudioEvent.INIT, enablerInitialized);
                } else {
                    enablerInitialized();
                }

                // If the enabled is initialized you can get the content
                function enablerInitialized() {

                    if (!Enabler.isVisible()) {
                        Enabler.addEventListener(studio.events.StudioEvent.VISIBLE, adVisible);
                    } else {
                        adVisible();
                    }

                    // Set profileId to load content from uploaded data
                    Enabler.setProfileId(10579549);
                    var devDynamicContent = {};
                                            devDynamicContent.Triumph_Google_Studio_2020_11_Prospecting_TW = [{}];
                        devDynamicContent.Triumph_Google_Studio_2020_11_Prospecting_TW[0].advert_id = "5fb3ab91549d9906321e7393";
                        devDynamicContent.Triumph_Google_Studio_2020_11_Prospecting_TW[0].theme = "Triumph_2020_November_SingleImage";
                        devDynamicContent.Triumph_Google_Studio_2020_11_Prospecting_TW[0].advert_name = "Message 8_Smart Fit";
                        devDynamicContent.Triumph_Google_Studio_2020_11_Prospecting_TW[0].background_image_2 = {};
                        devDynamicContent.Triumph_Google_Studio_2020_11_Prospecting_TW[0].background_image_2.Type = "file";
                        devDynamicContent.Triumph_Google_Studio_2020_11_Prospecting_TW[0].background_image_2.Url = "AW20AsiaFitSmartP014RGB_TIAW2020ATLImages_TI_MC.jpg";
                        devDynamicContent.Triumph_Google_Studio_2020_11_Prospecting_TW[0].background_image_3 = {};
                        devDynamicContent.Triumph_Google_Studio_2020_11_Prospecting_TW[0].background_image_3.Type = "file";
                        devDynamicContent.Triumph_Google_Studio_2020_11_Prospecting_TW[0].background_image_3.Url = "AW20FitSmartLaydown1RGB_TIAW2020BTLImages_TI_LD.jpg";
                        devDynamicContent.Triumph_Google_Studio_2020_11_Prospecting_TW[0].message = "Message 8";
                        devDynamicContent.Triumph_Google_Studio_2020_11_Prospecting_TW[0].background_image_1 = {};
                        devDynamicContent.Triumph_Google_Studio_2020_11_Prospecting_TW[0].background_image_1.Type = "file";
                        devDynamicContent.Triumph_Google_Studio_2020_11_Prospecting_TW[0].background_image_1.Url = "AW20AsiaFitSmartP011RGB_TIAW2020ATLImages_TI_MC.jpg";
                        devDynamicContent.Triumph_Google_Studio_2020_11_Prospecting_TW[0].brand_image_1 = {};
                        devDynamicContent.Triumph_Google_Studio_2020_11_Prospecting_TW[0].brand_image_1.Type = "file";
                        devDynamicContent.Triumph_Google_Studio_2020_11_Prospecting_TW[0].brand_image_1.Url = "brand-image-1.png";
                        devDynamicContent.Triumph_Google_Studio_2020_11_Prospecting_TW[0].copy_1 = "<span style=\"white-space: nowrap\">Fit Smart</span><span style=\"white-space: nowrap\">為你量身打造專屬尺寸</span> <span style=\"white-space: nowrap\">曲線由你而定</span>";
                        devDynamicContent.Triumph_Google_Studio_2020_11_Prospecting_TW[0].cta_1 = "了解更多";
                        devDynamicContent.Triumph_Google_Studio_2020_11_Prospecting_TW[0].click_url = "";

                    // Load dynamic content
                    // @return dynamicContent[contentName][0].headline_1
                    Enabler.setDevDynamicContent(devDynamicContent);

                    // Replace content if its loaded
                    // YOU MUST USE dynamicContent as OUTPUT

                    replaceContent(dynamicContent.Triumph_Google_Studio_2020_11_Prospecting_TW[0]);


                }

                
 
/**
 * Google Studio Content Replacer
 * @Version 0.2b
 * @Peter Buza
 *
 *
 * Google Studio give you a fancy Object to your content but you must replace things in DOM to see. This code can do it.
 * 
 * Example:
 *
 * <div class="headline_1">Default headline text</div> 
 *                 ^
 *     Its replaced becouse of this
 *
 * <img src="default-background.jpg" id="background_image_1">
 *
 * If placeholder name contains:
 *      'image': If tag is an img replace src, if not replace background-image e.g background_image_1, product_image_1
 *      'url': Change src tag e.g product_url, click_url
 *      'background' and 'color': Background color e.g. background_color_1, background_color_footer
 *      'color': Text color e.g. headline_color, footer_color_text
 *      'position': Background position css text e.g background_position_1
 *      'visible': Display css e.g cta_visible (animations can overwrite it)
 *      'opacity': Opacity css e.g background_opacity, cta_opacity (animations can overwrite it)
 *      'css': Import css file dynamically. Example from asset manager.
 *      'style': Style in text e.g. headline_style (animations can overwrite it)
 *      'api': If you have openweathermap api
 *
 *      If placeholder not contains these keys, its will replace content inside the tag
 *
 *      You can write placeholder names into the class="background_image_1" or id="product-image-1"
 *
 *
**/

// contentFields: Object of placeholders e.g. {headline_1: 'Buy now', background_image_1: '', ...}
function replaceContent(contentFields) {
	
	var url = "";
	var click_url = "";
	var elements = [];
	var value = "";
	var placeholder = "";
	var selector = "";
	var placeholders = Object.keys(contentFields);

	console.log("Dynamic Content loaded: ", contentFields);

	// Each in placeholders
	for (var i in placeholders) {
		placeholder = placeholders[i].toLowerCase();
		value = contentFields[placeholder];

		// Import css file
		if (placeholder.indexOf("css") !== -1) {
			var link = document.createElement("link");
			link.href = value;
			link.type = "text/css";
			link.rel = "stylesheet";
			document.getElementsByTagName("head")[0].appendChild(link);
			console.log("CSS file added to head: " + value);
			continue;
		}

		// Import javascript code
		if (placeholder.indexOf("script") !== -1) {
			var script = document.createElement("script");
			script.innerHTML = value;
			document.getElementsByTagName("head")[0].appendChild(script);
			console.log("Script is added to head: " + value);
			continue;
		} 


		// If its an url check it
		url = typeof value === 'object' && typeof value.Url !== 'undefined' ? value.Url : value;

		// Create dom query selector
		selector = [
			"#" + placeholder, // Find for #background_image_1
			"." + placeholder, // Find for .background_image_1
			"#" + placeholder.replace(/_/g, '-'), // Find for #background-image-1
			"." + placeholder.replace(/_/g, '-'), // Find for .background-image-1
			"[data-placeholder='" + placeholder + "']", // Find for [data-placeholder='background_image-1']
			"[data-placeholder='" + placeholder.replace(/_/g, '-') + "']", // Find for [data-placeholder='background-image-1']
		].join(', ');

		elements = document.querySelectorAll(selector);

		// If queried elements not found for placeholder
		if (!elements || !elements.length) {
			console.warn("Elements not found for placeholder: ", placeholder, " selector: " + selector);
			continue;
		}

		// Each in DOM elements
		for (var e = 0, element; element = elements[e]; e++) {
			try {

				// Replace images
				if (placeholder.indexOf("image") !== -1) {

					// If tag is img set src if not set background image
					if (element.tagName.toLowerCase() === "img") {
						console.log(placeholder, "image placeholder found, set src to: ", url);
						element.src = url;
					} else {
						console.log(placeholder, "image placeholder found, set background image to: ", url);
						element.style.backgroundImage = "url(\'" + url + "\')";
					}
					continue;
				}

				// Replace videos
				if (placeholder.indexOf("video") !== -1) {

					url = value.Url ? value.Url : value;

					// If tag is img set src if not set background image
					if (element.tagName.toLowerCase() === "video") {
						console.log(placeholder, "video placeholder found, set src to: ", url);
						element.src = url;
					}
					continue;
				}

				// Replace urls
				if (placeholder.indexOf("url") !== -1) {

					url = value.Url ? value.Url : value;

					// If tag nam is <a> set href
					if (element.tagName.toLowerCase() === "a") {
						console.log(placeholder, "url placeholder found, set href to: ", url);
						element.href = url;
						continue;
					}

					// Else its a click_url set onAdClick event
					console.log(placeholder, "is a click url, set onclick event and Exit url to: ", url);

					// Set click url
					window.click_url = url;

					element.onclick = function(event) {
						onAdClickEvent(event, window.click_url);
					}

					continue;
				}

				// Replace colors
				if (placeholder.indexOf("color") !== -1) {
					console.log(placeholder, "color placeholder found, set color to: ", value);
					if (placeholder.indexOf("background") !== -1) {
						element.style.backgroundColor = value;
					} else {
						element.style.color = value;
					}
					continue;
				}

				// Replace postions
				if (placeholder.indexOf("position") !== -1) {
					console.log(placeholder, "positioning placeholder found, set background position to: ", value);
					element.style.cssText += value;
					continue;
				}

				// Hide element
				if (placeholder.indexOf("visible") !== -1) {
					console.log(placeholder, "is ", value, ", " + (value ? "show" : "hide") + " elements");
					element.style.display = value;
					continue;
				}

				// Set opacity
				if (placeholder.indexOf("opacity") !== -1) {
					console.log(placeholder, "opacity placeholder found");
					element.style.opacity = value;
					continue;
				}

				// Append class name
				if (placeholder.indexOf("class") !== -1) {
					element.className += ' ' + value;
					continue;
				}

				// Set css
				if (placeholder.indexOf("style") !== -1) {
					console.log(placeholder, "css placeholder found");
					element.style.cssText += value;
					continue;
				}

				// Call api and get info
				if (placeholder.indexOf("api") !== -1) {
					callAPI(element, value);
					continue;
				}


				// Replace text placeholders
				if (typeof value === 'string') {
					console.log(placeholder, "placeholder found, set inner text to: ", value);
					element.innerHTML = value.toString().replace(/\n/g, "<br>");

					// Has child element show warning
					if (element.childElementCount) {
						console.warn("Element has", element.childElementCount, "children, please check it does not remove any important elements");
					}
					continue;
				}

				console.warn(placeholder, "placeholder not used (DOM not changed) value is (", typeof value , "): ", value);


			} catch (error) {
				console.error("Error found when replace placeholder: ", placeholder, "Element: ", element, "Error Message: ", error);
			}
		}
	}
}

// Trigger click tag. DO NOT USE WITH <a> tag
function onAdClickEvent(e, url) {
	console.log('Click tag triggered', url);
	Enabler.exitOverride('Click tag', url);
}

/*  
* Call api url
*
* If your data not in body, 
*/
function callAPI(element, url) {

	// For current URL: https://api.openweathermap.org/data/2.5/weather?q=budapest&units=metric&APPID=&show=main.temp
	// For daily URl: 
	if (!url) {
		console.error('Api url is not defined');
		return;
	}

	try {
		var value;

		// Get parameters to show
		var urlParams = new URLSearchParams(url); 

		// Get show parameters
		var showParam = urlParams.get('show') || ''; 

		// Array of ['main', 'temp'] or ['current', '2', 'temp']
		var showInCreative = showParam.split('.');

		var xhttp = new XMLHttpRequest();
		xhttp.onreadystatechange = function() {
			if (this.readyState == 4 && this.status == 200) {
				var json = JSON.parse(xhttp.responseText);
				if (typeof json === 'object') {

					console.log('API data received', json);

					// Get the value (find) main.temp
					value = json[showInCreative[0]];
					for (var i = 0; i < showInCreative.length; i++) {
						if (value[showInCreative[i]]) {
							value = value[showInCreative[i]];
						} else {
							console.error('Failed to get data ', showInCreative);
							return;
						}
					}

					// Set data in html
					if (value) {
						console.log('Data set in DOM: ', value);
						element.innerHTML = value;
						return;
					}

					console.error('Failed to load data from api');
				}

			} else {
				console.error('Failed to load API data: ' + this.status);
			}
		};
		xhttp.open("GET", url, true);
		xhttp.send();
	} catch (error) {
		console.error('Failed to load API data: ' + error);
	}
}


                function adVisible() {
                    // Ad visible, start ad/animation.
                }
            </script>
        
</head>
<body>

	<!-- Scene 1 -->
	<section class="scene-1" data-message="Message 8">
		
			<!-- Images block -->
			<div class="images-block">
					<div class="image-block background-image-1" id="background_image_1" style="background-image: url('f16f709a6b60e71acdad4808e4060b579ad327c5_1604318997_AW20AsiaFitSmartP011RGB_TIAW2020ATLImages_TI_MC.jpg');background-position-x: 55.70175438596491%;background-position-y: 0%;background-size: 100% auto"></div>
				</div>
			
			<!-- Brand block -->
			<div class="brand-block">
				<div class="brand-image-1">
					<img src="08be09601e77651d8a78e342d43f15fb68bb91aa_1604319997_brand-image-1.png">
				</div>
				<div class="copy-1"><span style="white-space: nowrap">Fit Smart</span><span style="white-space: nowrap">為你量身打造專屬尺寸</span> <span style="white-space: nowrap">曲線由你而定</span></div>
			</div>
			
			<!-- CTA block -->
			<div class="cta-block">
				<button class="cta-1" href="//">了解更多</button>
			</div>

	</section>


<!--/a-->
</body>
</html>
